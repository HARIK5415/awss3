ODSL.POA_RMTC = SELECT DISTINCT
   CLFCN.SYSTEM_ID AS SYSTEM_ID,
   'NA' AS POA_RMTNC_SPK,
   CLFCN.ODS_ROOT_SPK AS ODS_ROOT_SPK,
   POA.POA_SPK AS POA_SPK,
   ADRS.RMTNC_SPK AS RMTNC_SPK,
   CLFCN.BATCH_KEY AS BATCH_KEY,
   'NA' AS ENTITY_MD5,
   ADRS.RMTNC_ID AS RMTNC_ID,
   CONCAT(POA.POA_SPK,'.',ADRS.RMTNC_SPK,get_encrypted_key(ADRS.Remittance_Segment_Effective_Date,
                 ADRS.Remittance_Segment_Termination_Date,
                 ADRS.Remittance_Segment_Termination_Reason_Code) )  AS POA_RMTNC_KEY,
	POA.POA_KEY AS POA_KEY,
   'E' AS RMTNC_RLTNSHP_TYPE_CD,
   ADRS.Remittance_Segment_Effective_Date AS POA_RMTNC_EFCTV_DT, 
   CASE WHEN LEFT(ADRS.Remittance_Segment_Termination_Date,8) <> '99991231' 
   			THEN '303' ELSE '' 
   	END AS POA_RMTNC_TRMNTN_RSN_CD,
   to_odsl_format(ADRS.REMITTANCE_SEGMENT_TERMINATION_DATE) AS POA_RMTNC_TRMNTN_DT,
  'Service_ID' AS LAST_UPDT_USER_ID
	,CURRENT_TIMESTAMP AS LAST_UPDT_DT
	,'Service_ID' AS CREAT_USER_ID
	,CURRENT_TIMESTAMP as CREAT_DT
	,'NA' as AUDT_UPDT_RSN_CD
	,'NA' as AUDT_UPDT_RQST_ID
	,'NA' as POA_RMTNC_SOURCE_ID
	,''  as ODS_DERIVED_IND
	,'NA' as POA_RMTNC_EPDSV2_KEY
	,'NA' as PROV_EPDSV2_KEY

   FROM Y_PROV_CLSSFCTN CLFCN
    Inner JOin POA POA on
     POA.SYSTEM_ID=CLFCN.SYSTEM_ID and
     POA.PROV_SPK =CLFCN.PROV_SPK and
     POA.ODS_ROOT_SPK =CLFCN.ODS_ROOT_SPK
     and  CLFCN.PROV_CLSSFCTN_CD in ('OP','SO','MO')  
    Inner Join X_PREM_STNDRDZD_ADRS ADRS on  
     ADRS.Source_Provider_Identifier=CLFCN.SRC_PROV_ID and
     ADRS.SOURCE_PROVIDER_IDENTIFIER_SOURCE=CLFCN.SRC_PROV_ID_SRC
    LEFT Join gbd_ciff_raw.RMTNC d on  
   d.RMTNC_SPK = ADRS.RMTNC_SPK and 
   d.ODS_ROOT_SPK = ADRS.ODS_ROOT_SPK and 
    d.SYSTEM_ID=ADRS.SYSTEM_ID and 
d.POA_SOURCE_ID=ADRS.ADDRESS_IDENTIFIER;
